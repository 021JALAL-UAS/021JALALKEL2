<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PZEM Monitoring - Simulasi</title>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Canvas Gauges -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-gauges@2.1.7/gauge.min.js"></script>

  <style>
    body {
      background: #eef2f5;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }
    h2 {
      text-align: center;
      margin: 5px 0 20px 0;
      color: #222;
    }
    .section-title {
      margin: 30px 0 10px;
      font-size: 20px;
      font-weight: bold;
      color: #333;
      text-align: center;
    }

    .grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 25px;
      margin-bottom: 30px;
    }

    .card {
      background: white;
      border-radius: 12px;
      padding: 15px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.12);
      text-align: center;
      width: 240px;
    }

    .display {
      font-size: 32px;
      font-weight: bold;
      color: #0077b6;
      margin-top: 10px;
    }

    canvas {
      max-width: 100%;
    }
  </style>
</head>
<body>

  <h2>PZEM Real-Time Monitoring (Simulasi)</h2>
  <h2>Kelas Elektronika Daya - 2025</h2>

  <!-- ===== GAUGE SECTION ===== -->
  <div class="section-title">Gauge</div>
  <div class="grid">
    <div class="card"><canvas id="gVolt" data-type="radial-gauge" data-width="220" data-height="220" data-min-value="0" data-max-value="300" data-major-ticks="0,50,100,150,200,250,300" data-units="V" data-title="Tegangan"></canvas></div>
    <div class="card"><canvas id="gArus" data-type="radial-gauge" data-width="220" data-height="220" data-min-value="0" data-max-value="50"  data-major-ticks="0,10,20,30,40,50" data-units="A" data-title="Arus"></canvas></div>
    <div class="card"><canvas id="gDaya" data-type="radial-gauge" data-width="220" data-height="220" data-min-value="0" data-max-value="5000" data-major-ticks="0,1000,2000,3000,4000,5000" data-units="W" data-title="Daya"></canvas></div>
    <div class="card"><canvas id="gKwh"  data-type="radial-gauge" data-width="220" data-height="220" data-min-value="0" data-max-value="200" data-major-ticks="0,50,100,150,200" data-units="kWh" data-title="Energi"></canvas></div>
    <div class="card"><canvas id="gFrek" data-type="radial-gauge" data-width="220" data-height="220" data-min-value="40" data-max-value="60" data-major-ticks="40,45,50,55,60" data-units="Hz" data-title="Frekuensi"></canvas></div>
    <div class="card"><canvas id="gPf"   data-type="radial-gauge" data-width="220" data-height="220" data-min-value="0" data-max-value="1" data-major-ticks="0,0.2,0.4,0.6,0.8,1" data-units="" data-title="Power Factor"></canvas></div>
  </div>

  <!-- ===== DISPLAY SECTION ===== -->
  <div class="section-title">Display Angka</div>
  <div class="grid">
    <div class="card"><div>Tegangan</div><div id="dVolt" class="display">0</div></div>
    <div class="card"><div>Arus</div><div id="dArus" class="display">0</div></div>
    <div class="card"><div>Daya</div><div id="dDaya" class="display">0</div></div>
    <div class="card"><div>Energi</div><div id="dKwh"  class="display">0</div></div>
    <div class="card"><div>Frekuensi</div><div id="dFrek" class="display">0</div></div>
    <div class="card"><div>Power Factor</div><div id="dPf"   class="display">0</div></div>
  </div>

  <!-- ===== CHART SECTION ===== -->
  <div class="section-title">Grafik Smooth Line</div>
  <div class="grid">
    <div class="card"><canvas id="cVolt"></canvas></div>
    <div class="card"><canvas id="cArus"></canvas></div>
    <div class="card"><canvas id="cDaya"></canvas></div>
    <div class="card"><canvas id="cKwh"></canvas></div>
    <div class="card"><canvas id="cFrek"></canvas></div>
    <div class="card"><canvas id="cPf"></canvas></div>
  </div>

<script>
/* ============================
   SETUP CHART.JS (6 grafik)
============================ */
function createChart(id, label) {
  return new Chart(document.getElementById(id), {
    type: "line",
    data: {
      labels: [],
      datasets: [{
        label: label,
        data: [],
        borderWidth: 2,
        tension: 0.5
      }]
    },
    options: {
      responsive: true,
      plugins: { legend: { display: false } },
      scales: {
        x: { display: false },
        y: { beginAtZero: true }
      }
    }
  });
}

const chartVolt = createChart("cVolt","Volt");
const chartArus = createChart("cArus","Arus");
const chartDaya = createChart("cDaya","Daya");
const chartKwh  = createChart("cKwh","Energi");
const chartFrek = createChart("cFrek","Frekuensi");
const chartPf   = createChart("cPf","PF");

/* ============================
   SIMULASI DATA
============================ */
function updateCharts(chart, value) {
  chart.data.labels.push("");
  chart.data.datasets[0].data.push(value);

  if (chart.data.labels.length > 40) {
    chart.data.labels.shift();
    chart.data.datasets[0].data.shift();
  }

  chart.update();
}

window.addEventListener("load", () => {
  setInterval(() => {

    let volt = 210 + Math.random() * 40;
    let arus = Math.random() * 10;
    let daya = volt * arus;
    let kwh  = (Math.random() * 20).toFixed(2);
    let frek = 49 + Math.random() * 2;
    let pf   = (0.6 + Math.random() * 0.4).toFixed(2);

    // Update Gauge
    gVolt.value = volt;
    gArus.value = arus;
    gDaya.value = daya;
    gKwh.value  = kwh;
    gFrek.value = frek;
    gPf.value   = pf;

    // Update Display
    dVolt.textContent = volt.toFixed(1);
    dArus.textContent = arus.toFixed(2);
    dDaya.textContent = daya.toFixed(0);
    dKwh.textContent  = kwh;
    dFrek.textContent = frek.toFixed(2);
    dPf.textContent   = pf;

    // Update Chart
    updateCharts(chartVolt, volt);
    updateCharts(chartArus, arus);
    updateCharts(chartDaya, daya);
    updateCharts(chartKwh,  kwh);
    updateCharts(chartFrek, frek);
    updateCharts(chartPf,   pf);

  }, 1000);
});
</script>

</body>
</html>
